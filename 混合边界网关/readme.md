## 边界网关

### 基本概念

边界网关(BGW，Border Gateway)，是京东云用来承载VPC南北向流量的一种网关，主要作用是与其他外部网关或环境进行内网互通。

在边界网关支持创建VPC接口功能前，边界网关一旦创建、即自动与同地域的所有VPC连通。

随着边界网关的VPC接口功能上线，新建的边界网关默认不与任何VPC连通，用户需要创建"VPC接口”用于打通指定VPC和边界网关的互联；对于已经创建的边界网关，边界网关路由表内已有到VPC的路由仍然有效可用，但是不能新建到VPC的路由、除非先创建出与VPC关联的VPC接口。

目前边界网关承载的业务是专线连接、托管连接、VPN连接、VPC接口功能。

边界网关支持客户IDC和京东云VPC之间通信、京东云托管区和京东云VPC之间通信、京东云同地域多个VPC之间通信等。

默认情况下，连接到同一边界网关的专线通道、托管通道、VPN连接之间无法通过边界网关进行通信。

通过边界网关可访问的京东云资源：京东云VPC内的全部资源，包括云主机、容器、负载均衡、云数据库、云缓存等，但是不能利用VPC内NAT网关统一互联网出口。

# VIP集群版本架构优势
# BGW机器的变更需要给路由器下发配置，之前的BGW的机器替换耗时很久

集群版本下，所有的节点都是等价的

机器的添加和删除 不需要等待路由器

优势：

1.运维角度看节省时间和大量的人力

2.稳定性的角度看，避免了人为介入的操作流程过多产生线上问题

# 之前的BGW机器出现问题的时候，如果机器Crash或者出现问题，需要依赖探测摘除收敛

集群版本下，所有的机器和上联交换机BGP连接宣告，靠BGP直接自动收敛

优势：

1.稳定性角度看，bgp的自动收敛时间短，故障恢复快

2.架构角度看，靠bgp的方案不依赖过多的外部中间件，架构简单

# BGW旧版没有多组互相灾备能力，同时没有异构的能力

集群版本下，多个bgw集群之间可以相互宣告相同的vip，靠路由自动故障转移

线上实现为硬件集群和软件集群之间异构相互宣告vip

优势：

1.稳定性角度看

a。异构的设计，可以避免硬件或者编程语言的问题

b。大小vip的宣告，可以在单个集群故障时快速自动灾备

2.架构角度看，直接大小段的vip宣告，不涉及其他模块开发和适配工作，架构简单